# プロジェクト状況レポート

## 現在の状況
**フェーズ:** 当たり判定ロジックのリファクタリング (完了)

データ駆動型の当たり判定システムへの移行が完了し、新機能の実装も進んでいます。

### 1. エンジン (`engine.js`)
- **完全なデータ駆動化**: 古いハードコードされたフォールバックロジックは完全に削除されました。
- **新機能の実装**: 以下の高度な当たり判定振る舞いがサポートされています。
    - `DESTROY`: 通常の破壊
    - `PIERCE`: 貫通 (貫通回数指定可能)
    - `REFLECT`: 反射 (壁やシールドでの反射、減衰率指定可能)
    - `SPLIT`: 分裂 (着弾時に別の弾をばら撒く)
    - `DIRECTIONAL_SHIELD`: 指向性シールド (特定の角度からの攻撃を防ぐ/反射する)

### 2. ライブラリ (`data/library/`)
- **定義の更新**: 全ての既存エンティティが新しい形式に更新済みです。
- **新エンティティの追加**: 新機能を活用した以下の弾が定義済みです。
    - `ricochet_orb`: 壁で反射する弾 (`REFLECT` 使用)
    - `split_burst`: 着弾時に分裂する弾 (`SPLIT` 使用)
    - `test_piercing_laser`: 貫通テスト用のレーザー (`PIERCE` 使用)

### 3. パック
- 既存のパック (`Sci-Fi`, `Fantasy`, `Bullet Hell`) は問題なく動作するはずですが、新機能（反射や分裂）を使用したステージ構成はまだ行われていません。

## 次のステップ
1. **シミュレーターの機能拡張**:
   - 現在のシミュレーター (`sim/test_simulator.html`) では、弾の挙動スクリプトは編集できますが、当たり判定パラメータ (`collision`) を直接編集するUIがありません。
   - **JSONエディタの追加**: シミュレーター上で `collision` プロパティ（形状、サイズ、振る舞いなど）をJSON形式で直接編集・適用できるように改修します。これにより、リロードなしで当たり判定の調整が可能になります。

2. **動作検証 (Verification)**:
   - シミュレーターの改修後、それを使用して `ricochet_orb` や `split_burst` の挙動を詳細にテストします。

3. **ステージへの組み込み**:
   - 検証完了後、これらの新しい弾幕パターンを実際のステージデータに組み込みます。

## 推奨事項
まずは**シミュレーターの機能拡張**を行い、効率的なテスト環境を整えることを推奨します。
